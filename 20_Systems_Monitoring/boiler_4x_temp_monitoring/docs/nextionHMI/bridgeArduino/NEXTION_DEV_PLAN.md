# Nextion HMI 개발 협업 가이드 및 Rev06 이식 계획

이 문서는 아두이노 나노를 바이패스(Bypass) 모드로 사용하여 Nextion HMI를 개발할 때의 역할 분담과 `mainrev06` 시스템의 기능을 HMI로 구현하기 위한 개발 계획을 담고 있습니다.

---

## 1. 역할 분담 안내 (Role Definition)

Nextion 디스플레이 개발은 하드웨어와 소프트웨어 디자인이 분리되어 있으므로 효율적인 협업을 위해 다음과 같이 역할을 나눕니다.

### 🤖 GitHub Copilot (AI 어시스턴트)의 역할
- **시스템 로직 설계:** 센서 데이터를 수집하고 이를 Nextion 명령어 형식으로 가공하는 아두이노 코드 작성.
- **명령어 가이드:** Nextion 명령어 세트(Instruction Set)를 기반으로 배경색 변경, 텍스트 업데이트, 페이지 전환 등의 문법 제공.
- **데이터 처리:** 실시간 온도 차($\Delta T$) 계산, 통계 데이터(Max/Min) 추출 및 UI 전송 로직 구현.
- **트러블슈팅:** 통신 에러 분석 및 바이패스 모드 설정 최적화 가이드.

### 🧑 사용자 (개발자)의 역할
- **GUI 시각 디자인:** Nextion Editor를 사용하여 프로젝트의 폰트 생성, 이미지 배치, 컴파일 및 업로드 수행.
- **컴포넌트 정의 및 공유:** 각 화면 요소(Button, Text, Gauge)의 이름(`objname`)과 ID를 결정하고, 이를 [objName_ID.json](../../src/main/mainrev07_tftlcd/objName_ID.json) 파일에 기록하여 AI와 공유.
- **물리적 배선 및 테스트:** 아두이노 나노와 Nextion 간의 실제 연결 관리 및 바이패스 모드를 통한 장치 테스트.

---

## 2. 현재 상태: 바이패스(Bypass) 모드 브릿지
현재 아두이노 나노는 **전용 USB-to-TTL 변환기**처럼 동작하고 있습니다.
- **목적:** Nextion Editor의 [Debug] 모드와 [Upload] 기능을 아두이노 보드를 통해 직접 수행하기 위함.
- **연결 방식:** 아두이노 RX(0)-넥션 TX(파랑), 아두이노 TX(1)-넥션 RX(노랑) 방식의 직결 구조.
- **이점:** 별도의 FTDI 모듈 없이도 PC에서 실시간으로 화면을 제어하고 수정 사항을 즉시 반영 가능.

---

## 3. mainrev06 기능 이식 계획 (Nextion HMI)

`mainrev06`에서 제공하는 고급 분석 기능을 Nextion의 그래픽 성능을 활용하여 다음과 같이 재구성합니다.

### 3.1 화면 구성 (Page Layout)
- **Page 0 (Overview):** 4개 센서의 실시간 온도 및 시스템 상태(WiFi, SD Log) 요약.
- **Page 1 (Delta Analysis):** $\Delta T_1$ (보일러 입/출구)와 $\Delta T_2$ (분배기 입/출구) 전용 시각화 페이지.
- **Page 2 (Graph/Chart):** 실시간 온도 변화를 파형으로 출력 (Nextion Waveform 컴포넌트 활용).
- **Page 3 (Setting):** 경고 임계치(Threshold) 설정 및 데이터 수집 주기(Interval) 조정 UI.

### 3.2 핵심 기능 구현 전략
1. **고급 시각화:** 20x4 LCD의 단순 텍스트를 벗어나 **Gauge(게이지)**와 **Slider(슬라이더)**를 사용하여 시각적 직관성 강화.
2. **지능형 알람:** `mainrev06`의 동적 임계치 기능을 활용, 온도 초과 시 Nextion의 배경색을 빨간색으로 변경하거나 팝업창 띄우기.
3. **통계 데이터 표시:** 실시간으로 계산된 평균 및 최대/최소 온도를 전용 텍스트 컴포넌트에 즉시 업데이트.
4. **이벤트 태깅:** 시스템 상태 변화(가동/정지) 발생 시 화면 하단 상태바(Status Bar)에 텍스트 표기.

---

## 4. 향후 작업 순서
1.  **디자인 스케치:** 사용자가 Nextion Editor에서 기본 레이아웃(`t0`, `t1`, `j0` 등) 설계.
2.  **프로토콜 정의:** AI와 사용자가 주고받을 데이터 데이터셋(예: `#T1:25.5#`) 규격 확립.
3.  **코드 통합:** 바이패스 모드를 해제하고, `mainrev06` 코드에 `Nextion.h` 라이브러리를 통합하여 실제 데이터 전송 시작.
