# 02_powerOnOffRepeat.ino 코드 리뷰

## 개요
이 문서는 `02_powerOnOffRepeat.ino` 파일의 코드를 리뷰한 내용입니다. 해당 코드는 온/오프 시간 지정 모터 구동을 위한 아두이노 스케치로, 가변저항으로 시간을 제어하고 서보모터를 제어하는 기능을 제공합니다.

## 주요 기능
1. **가변저항을 통한 시간 제어**
   - 첫 번째 가변저항(A0): ON 상태 지속 시간 조절
   - 두 번째 가변저항(A1): OFF 상태 지속 시간 조절

2. **서보모터 제어**
   - 서보모터 1(핀 10): ON/OFF에 따라 0° 또는 180° 회전
   - 서보모터 2(핀 11): ON/OFF에 따라 0° 또는 180° 회전

3. **환경 모니터링**
   - DHT22 센서를 통한 온도와 습도 측정
   - OLED 디스플레이에 현재 상태 및 환경 정보 표시

4. **상태 모니터링**
   - 시리얼 모니터를 통한 모터 상태 및 시간 설정값 확인

## 코드 구조 분석

### 헤더 및 라이브러리
- `U8glib.h`: OLED 디스플레이 제어용 라이브러리
- `DHT.h`: DHT 온습도 센서 제어용 라이브러리
- `Servo.h`: 서보모터 제어용 라이브러리

### 주요 변수
- **디바이스 설정 변수**: 센서, 모터, 가변저항 등의 핀 번호 설정
- **타이머 관련 변수**: 시간 측정 및 지연을 위한 변수들
- **모터 상태 변수**: 모터의 현재 상태(ON/OFF) 저장

### 주요 함수
1. `setup()`: 초기 설정 함수
   - 시리얼 통신 초기화
   - 센서 및 서보모터 초기화
   - 서보모터 초기 위치 설정

2. `loop()`: 메인 루프 함수
   - 현재 시간 업데이트
   - 온습도 측정
   - 서보모터 제어
   - 가변저항 값 읽기 및 매핑
   - 디스플레이 업데이트
   - 디버깅 정보 출력

3. `temp_humidity()`: 온습도 측정 함수
   - 2.5초 간격으로 DHT22 센서에서 온도와 습도 데이터 읽기
   - 시리얼 모니터에 결과 출력

4. `water_motor_control()`: 서보모터 제어 함수
   - 설정된 시간에 따라 모터 상태 전환
   - ON/OFF 상태에 따라 서보모터 각도 설정

5. `oled_Display()`: OLED 디스플레이 업데이트 함수
   - 온도, 습도 표시
   - 모터 상태(ON/OFF) 표시

6. `potentiometerMapping()`, `potentiometerMapping2()`: 가변저항 값 매핑 함수
   - 가변저항 값을 읽고 설정 시간으로 매핑
   - 시간과 분 형식으로 변환
   - 타이머 간격 설정

7. `serialPrint()`: 디버깅 정보 출력 함수
   - 2.5초 간격으로 모터 상태, 서보 각도, 가변저항 값, 시간 설정값 등 출력

## 개선된 사항

원본 코드(`onoffselectMotor.ino`)에서 다음과 같은 개선이 이루어졌습니다:

1. **코드 구조화**
   - 함수별로 기능 분리 및 명확한 주석 처리
   - 변수 그룹화로 가독성 향상

2. **알고리즘 개선**
   - 시간 계산 로직 개선(나머지 연산자 `%` 사용)
   - 시간 변환 기능 추가(시간과 분 형식)

3. **디버깅 기능 확장**
   - 시리얼 모니터에 더 상세한 정보 출력
   - 시간 단위 표시 개선

4. **주석 및 문서화**
   - 자세한 주석으로 코드 이해도 향상
   - 한글 주석으로 명확한 기능 설명

## 향후 개선 가능 사항

1. **에너지 효율성**
   - 불필요한 연산 최소화
   - 타이머 관리 최적화

2. **사용자 인터페이스**
   - OLED 디스플레이에 더 많은 정보 표시(예: 설정된 타이머 시간)
   - 상태 변경 시 시각적 피드백 추가

3. **오류 처리**
   - 센서 오류 시 복구 메커니즘
   - 시스템 안정성 향상을 위한 예외 처리

4. **설정 저장**
   - EEPROM을 활용한 설정값 저장
   - 재시작 후에도 이전 설정 유지

## 결론
`02_powerOnOffRepeat.ino` 코드는 원본 `onoffselectMotor.ino` 코드를 크게 개선했습니다. 코드 구조화, 알고리즘 개선, 주석 처리 등을 통해 가독성과 유지보수성이 향상되었습니다. 추가적인 기능 확장과 에러 처리를 통해 더욱 안정적인 시스템으로 발전될 수 있습니다.