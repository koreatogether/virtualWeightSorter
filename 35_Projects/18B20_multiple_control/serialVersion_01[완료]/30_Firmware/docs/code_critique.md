# 기술 비평 보고서: DS18B20 시리얼 제어 시스템 (v01)

## 1. 개요
본 문서는 `serialVersion_01` 펌웨어 코드의 아키텍처, 구현 방식 및 잠재적 위험 요소에 대한 비판적 분석을 제공합니다. 본 프로젝트는 기능적으로는 완성된 상태이나, 확장성, 유지보수성, 그리고 임베디드 환경의 제약 사항 측면에서 몇 가지 중대한 설계 결함을 가지고 있습니다.

## 2. 아키텍처 분석 및 비평

### 2.1 과도한 추상화와 오버엔지니어링 (Over-engineering)
*   **문제점**: 단순한 온도 로깅 및 시리얼 메뉴 시스템임에도 불구하고 `App`, `DataProcessor`, `Communicator`, `DS18B20_Sensor` 등 고수준 객체 지향 패턴을 과도하게 적용했습니다.
*   **비판**: 8비트/32비트 마이크로컨트롤러 환경에서 모든 메서드를 `virtual`로 선언하는 것은 VTable로 인한 메모리 낭비와 호출 오버헤드를 발생시킵니다. 특히 단일 구현체만 존재하는 상황에서의 인터페이스 분리는 불필요한 복잡성만 가중시킵니다.

### 2.2 거대 클래스 (God Object - App Class)
*   **문제점**: `App.cpp` 파일의 크기가 약 45KB에 달하며, UI 출력, 입력 파싱, 센서 상태 관리, 타이밍 제어 등 모든 로직이 한 클래스에 집중되어 있습니다.
*   **비판**: 이는 단일 책임 원칙(SRP)을 정면으로 위배합니다. 메뉴 로직이 수정될 때 센서 관리 로직이 영향을 받을 수 있으며, 코드 가독성이 현저히 떨어집니다. UI 코드(텍스트 메뉴)는 별도의 컴포넌트로 분리되었어야 합니다.

### 2.3 차단형(Blocking) 로직의 잔재
*   **문제점**: `readUserInput(timeout)` 및 `delay()`를 사용하는 구조가 여전히 존재합니다.
*   **비판**: `Communicator`에 비차단형 함수가 추가되었음에도 불구하고, `App`의 상태 머신 처리가 선형적이고 응답 대기 위주로 설계되어 있어 멀티태스킹 확장(예: 웹 서버 동시 운영) 시 시스템의 반응성이 급격히 저하될 우려가 있습니다.

## 3. 구현 세부 사항 비평

### 3.1 위험한 동적 메모리 활용
*   **문제점**: `main.cpp`의 테스트 코드나 `App` 로직 내에서 `String` 객체와 동적 배열 할당(`new String[5]`)이 사용되고 있습니다.
*   **비판**: 힙(Heap) 공간이 제한적인 ESP32/Arduino 환경에서 `String`의 빈번한 생성과 해제는 메모리 파편화(Fragmentation)를 유발하여 원인 모를 시스템 크래시를 발생시킬 수 있습니다. 특히 `performRuntimeMemoryTest` 같은 함수는 테스트 자체가 메모리 고갈 문제를 야기할 수 있는 모순적인 구현입니다.

### 3.2 하드코딩된 제약 사항
*   **문제점**: `SENSOR_COUNT`나 `sensorsToChangeArray[8]` 등 센서 개수가 하드코딩된 배열로 관리됩니다.
*   **비판**: 8개 이상의 센서를 연결해야 하는 상황에서 코드 전반의 상수를 수정하고 재컴파일해야 하는 번거로움이 있습니다. 동적 할당은 위험하지만, 정적 할당 시에도 유연한 구조(Linked List 등)나 최소한의 추상화가 부족합니다.

### 3.3 캡슐화 위반
*   **문제점**: "For testing"이라는 명목하에 많은 내부 멤버 변수를 `public`으로 노출하고 있습니다.
*   **비판**: 이는 객체 지향 설계의 핵심인 캡슐화를 포기한 것으로, 외부에서 객체의 상태를 직접 조작할 수 있게 되어 버그 발생 가능성이 높습니다. 테스트를 위한 설계였다면 `friend` 클래스나 Mock 객체를 통한 정밀한 접근이 필요했습니다.

## 4. 결론 및 제언
현재의 코드는 **"작동하는 데 급급한 데스크탑 애플리케이션 스타일의 임베디드 코드"**라고 평가할 수 있습니다. 

### 향후 개선 방향:
1.  **UI 분리**: 시리얼 메뉴 출력 로직을 별도의 UI 핸들러로 분리.
2.  **비차단형 설계**: 모든 입력을 이벤트 기반(Interrupt or Non-blocking Poll)으로 전환.
3.  **정적 메모리 최적화**: `String` 사용을 지양하고 `char` 버퍼와 `snprintf` 사용 권장.
4.  **인터페이스 간소화**: 불필요한 `virtual` 제거 및 실제 필요한 수준만큼만 추상화 유지.

이러한 개선이 이루어지지 않는다면, 현재 프로젝트는 기능을 조금만 추가해도 유지보수가 불가능한 스파게티 코드가 될 위험이 큽니다.
